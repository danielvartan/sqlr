devtools::load_all(".")
test <- read_ris(file)
devtools::load_all(".")
test <- read_ris(file)
devtools::load_all(".")
test <- read_ris(file)
classt(test)
class(test)
head)test
head(test)
class(data.frame(a = 1))
debugonce(join_ris_solo_lines)
test <- read_ris(file)
test <- read_ris()
debugonce(join_ris_solo_lines)
test <- read_ris()
devtools::load_all(".")
debugonce(join_ris_solo_lines)
test <- read_ris(raw_data("citation", "2021-04-27_citations_pubmed_en_1-2869.zip"))
Q
apa <- read_ris()
stop("The number of RIS tags doesn't match the number of values ",
"in at least one record.")
stop("The number of RIS tags doesn't match the number of values ",
"in at least one record.", call. = FALSE)
devtools::load_all(".")
test <- head(apa, 10)
View(test)
names(apa)
devtools::load_all(".")
tempdir()
normalizePath(tempdir())
normalizePath(tempdir(), "/")
writeLines(names(apa))
writeLines(names(apa), tempfile())
test$AD[1]
test$AD[5]
View(apa)
temp <- dplyr::select(apa, M3, DO)
View(temp)
dplyr::tibble(_redundancy = 1)
dplyr::tibble(.redundancy = 1)
rm_na(apa$T3)
rm_na(apa$A2)
which(!is.na(apa$A2))
View(apa)
temp <- dplyr::slice(apa, 215)
temp$A1
temp$T1
provider_tags$apa
source('C:/Midia/GitHub/sqlr/data-raw/provider_tags.R')
test <- provider_tags
test <- provider_tags()
rm(provider_tags())
source('C:/Midia/GitHub/sqlr/data-raw/ris_tags.R')
temp <- ris_tags()
View(temp$apa)
source('C:/Midia/GitHub/sqlr/data-raw/ris_tags.R')
temp <- ris_tags()
View(temp$apa)
temp$apa
test <- temp$apa
?dplyr::relocate()
dplyr::relocate(test, order, category)
source('C:/Midia/GitHub/sqlr/data-raw/ris_tags.R')
ris_tags(TRUE)
devtools::load_all(".")
rm(ris_tags)
ris_tags$apa
inherits(temp, "character")
inherits(temp, "list")
args(checkmate::assert_choice)
inherits(temp$apa, "list")
inherits(temp$apa, "tibble")
inherits(temp$apa, "data.frame")
class(temp$apa)
inherits(temp$apa, "tbl")
checkmate::assert_data_frame(temp$apa, min.rows = 1, min.cols = 3,
col.names = c("tag", "order", "name"))
?checkmate::assert_data_frame
checkmate::assert_data_frame(temp$apa, min.rows = 1, min.cols = 3,
col.names = check_subset(temp$apa, "tag", "order", "name"))
checkmate::assert_data_frame(temp$apa, min.rows = 1, min.cols = 3,
col.names = checkmate::check_subset(temp$apa, "tag", "order", "name"))
checkmate::assert_data_frame(temp$apa, min.rows = 1, min.cols = 3,
col.names = checkmate::check_subset(temp$apa, c("tag", "order", "name")))
tag_pattern <- temp$apa
choices <- c("tag", "order", "name")
checkmate::assert_data_frame(tag_pattern, min.rows = 1, min.cols = 3)
checkmate::assert_subset(names(tag_pattern), choices, empty.ok = FALSE)
names(tag_pattern)
?checkmate::assert_names()
checkmate::assert_names(names(tag_pattern), must.include = choices)
choices <- c("tag", "order", "name", "test")
checkmate::assert_names(names(tag_pattern), must.include = choices)
choices <- c("tag", "order", "name")
checkmate::assert_data_frame(tag_pattern, min.rows = 1, min.cols = 3)
checkmate::assert_names(names(tag_pattern), must.include = choices)
inherits(NULL, "character")
inherits(NULL, "NULL")
ris_tags["apa"]
ris_tags[["apa"]]
x <- apa
names(x)
names(tag_pattern)
tag_pattern$tag
which(names(x) %in% tag_pattern$tag)
test <- apend(tag_pattern$tag, "test")
test <- append(tag_pattern$tag, "test")
which(names(x) %in% test)
test
tag_pattern %>% dplyr::arrange(order)
tag_pattern <- tag_pattern %>% dplyr::arrange(order)
replacement_cols <- tag_pattern$tag[which(names(x) %in% tag_pattern$tag)]
replacement_cols
tag_pattern <- tag_pattern %>% dplyr::arrange(order)
replacement_cols <- tag_pattern$tag[which(names(x) %in% tag_pattern$tag)]
replacement_cols
x <- x %>%
dplyr::relocate(replacement_cols)
x <- x %>%
dplyr::relocate(dplyr::all_of(replacement_cols))
x
x <- apa
x <- dplyr::mutate(test = 1)
x <- dplyr::mutate(x, test = 1)
View(x)
x <- x %>%
dplyr::relocate(dplyr::all_of(replacement_cols))
names(x)
tag_pattern <- tag_pattern %>% dplyr::arrange(order)
replacement_index <- which(names(x) %in% tag_pattern$tag)
replacement_tag <- tag_pattern$tag[replacement_index]
replacement_name <- tag_pattern$name[replacement_index]
replacement_tag
replacement_name
x <- x %>%
dplyr::relocate(dplyr::all_of(replacement_tag)) %>%
dplyr::rename(replacement_name)
x <- apa
x <- x %>%
dplyr::relocate(dplyr::all_of(replacement_tag)) %>%
dplyr::rename(dplyr::all_of(replacement_name))
?dplyr::rename
x <- x %>%
dplyr::relocate(dplyr::all_of(replacement_tag)) %>%
dplyr::rename(replacement_name,
dplyr::all_of(replacement_name))
x <- x %>%
dplyr::relocate(dplyr::all_of(replacement_tag)) %>%
dplyr::rename(replacement_name,
dplyr::all_of(replacement_tag))
x <- x %>%
dplyr::relocate(dplyr::all_of(replacement_tag)) %>%
dplyr::rename_with(replacement_name,
dplyr::all_of(replacement_tag))
x <- x %>%
dplyr::relocate(dplyr::all_of(replacement_tag)) %>%
dplyr::rename_with(function(x) replacement_name,
dplyr::all_of(replacement_tag))
names(x)
View(x)
x <- apa
x <- dplyr::mutate(x, test = 1)
x <- x %>%
dplyr::relocate(dplyr::all_of(replacement_tag)) %>%
dplyr::rename_with(function(x) replacement_name,
dplyr::all_of(replacement_tag))
View(x)
devtools::load_all(".")
temp <- rename_ris(apa)
temp <- rename_ris(apa, "apa")
View(temp)
View(apa)
provider_code <- list(
apa = list(name = "apa", sheet = "APA")
# ebsco = list(name = "ebsco", sheet = "EBSCO"),
# embase = list(name = "embase", sheet = "Embase"),
# pubmed = list(name = "pubmed", sheet = "PubMed"),
# scopus = list(name = "scopus", sheet = "Scopus"),
# wos = list(name = "wos", sheet = "Web of Science")
)
code_lookup <- list(
apa = list(code = "apa", name = "APA")
# ebsco = list(code = "ebsco", name = "EBSCO"),
# embase = list(code = "embase", name = "Embase"),
# pubmed = list(code = "pubmed", name = "PubMed"),
# scopus = list(code = "scopus", name = "Scopus"),
# wos = list(code = "wos", name = "Web of Science")
)
code_lookup <- list(apa = "APA", ebsco = "EBSCO", embase = "Embase",
pubmed = "PubMed", scopus = "Scopus",
wos = "Web of Science")
code_lookup[["apa"]]
provider <- code_lookup[[tag_pattern]]
provider <- code_lookup[["apa"]]
provider
"provider" %in% ls()
ls()
?ls
devtools::load_all(".")
devtools::load_all(".")
temp <- rename_ris(apa)
temp <- rename_ris(apa, ris_tags$apa, "TEST")
temp <- head(temp, 10)
View(temp)
names(temp)
temp <- rename_ris(apa, "apa", "TEST")
temp <- head(temp, 10)
raw_data("citation")[1]
raw_data("citation", raw_data("citation")[1])
test <- raw_data("citation", raw_data("citation")[1])
stringr::str_extract(test, "(?<=//).+$")
stringr::str_extract(test, "(?<=/).+$")
stringr::str_extract(test, "(?<=\).+$")
stringr::str_extract(test, "(?<=\\).+$")
stringr::str_extract(test, "(?<=\/).+$")
stringr::str_extract(test, "(?<=\\/).+$")
stringr::str_extract(test, "(?<=[\\/]).+$")
stringr::str_extract(test, "^\\(.+\\)*(.+)\.(.+)$")
stringr::str_extract(test, "[ \w-]+\.")
stringr::str_extract(test, "[ \\w-]+\\.")
stringr::str_extract(test, "^\\(.+\\)*(.+)\\.(.+)$")
stringr::str_extract(test, "^\\\(.+\\\)*(.+)\\.(.+)$")
stringr::str_extract(test, "^\\(.+\\)*.+\\.(.+)$")
stringr::str_extract(test, "[ \\w-]+\\.")
stringr::str_extract(test, "[ \\w-]+.+")
stringr::str_extract(test, "[ \\w-]+\\..+")
stringr::str_extract(test, "[^\\]+")
stringr::str_extract(test, "[^\\]+$")
stringr::str_extract(test, "[^\\].+$")
stringr::str_extract(test, "[^\\\].+$")
stringr::str_extract(test, "[^\\-].+$")
stringr::str_extract(test, "[^\\\\].+$")
test
stringr::str_extract(test, "[^/].+$")
stringr::str_extract(test, "[^//].+$")
basename(test)
basename("2021-04-27 - Citations - APA - EN - 1-500.ris")
basename("sadsadsa/dsadas/2021-04-27 - Citations - APA - EN - 1-500.ris")
View(temp)
devtools::load_all(".")
devtools::load_all(".")
ebsco <- read_ris()
devtools::load_all(".")
ebsco <- read_ris()
View(ebsco)
raw_data("citation")
grep("APA", raw_data("citation"))
grepl("APA", raw_data("citation"))
grep("APA", raw_data("citation"))
grep("apa", raw_data("citation"))
grep("_apa_", raw_data("citation"))
raw_data("citation")[grep("_apa_", raw_data("citation"))]
citations <- raw_data("citation")
citatons[grep("_apa_", citatons)]
citations[grep("_apa_", citations)]
citations <- raw_data("citation")
file <- citations[grep("_apa_", citations)]
file <- raw_data("citation", file)
file
devtools::load_all(".")
apa <- read_ris(file, "apa")
debugonce(rename_ris)
apa <- read_ris(file, "apa")
x
provider
tag_pattern
names(x)
replacement_index
replacement_tag
replacement_name
names(x)
dplyr::relocate(x, dplyr::all_of(replacement_tag))
names(x)
ls()
apa <- read_ris(file, "apa")
devtools::load_all(".")
apa <- read_ris(file, "apa")
?dplyr::relocate
debugonce(rename_ris)
apa <- read_ris(file, "apa")
replacement_tag
names(x)
apa <- read_ris(file, "apa")
devtools::load_all(".")
devtools::load_all(".")
apa <- read_ris(file, "apa")
devtools::load_all(".")
apa <- read_ris(file, "apa")
test <- dplyr::tibble(a = 1, b = 2, c = 3)
dplyr::relocate(test, 3, 2, 1)
apa <- read_ris(file)
names(apa)
x <- apa
tag_pattern <- "apa"
checkmate::assert_data_frame(x)
checkmate::assert_multi_class(tag_pattern, c("character", "data.frame"),
null.ok = TRUE)
checkmate::assert_string(file)
if (inherits(tag_pattern, "character")) {
choices <- c("apa", "ebsco", "embase", "pubmed", "scopus", "wos")
checkmate::assert_choice(tag_pattern, choices)
code_lookup <- list(apa = "APA", ebsco = "EBSCO", embase = "Embase",
pubmed = "PubMed", scopus = "Scopus",
wos = "Web of Science")
provider <- code_lookup[[tag_pattern]]
tag_pattern <- ris_tags[[tag_pattern]]
} else if (inherits(tag_pattern, "data.frame")) {
choices <- c("tag", "order", "name")
checkmate::assert_data_frame(tag_pattern, min.rows = 1, min.cols = 3)
checkmate::assert_names(names(tag_pattern), must.include = choices)
} else {
return(x)
}
tag_pattern <- tag_pattern %>% dplyr::arrange(order)
replacement_index <- which(names(x) %in% tag_pattern$tag)
replacement_tag <- tag_pattern$tag[replacement_index]
replacement_name <- tag_pattern$name[replacement_index]
replacement_index
dplyr::relocate(test, c(3, 2, 1))
devtools::load_all(".")
apa <- read_ris(file, "apa")
debugonce(rename_ris)
devtools::load_all(".")
debugonce(rename_ris)
apa <- read_ris(file, "apa")
temp <- head(x, 10)
View(temp)
replacement_tag
replacement_name
temp[c(3,2,1)]
names(x)
replacement_index
which(replacement_tag %in% names(x))
which(replacement_tag == names(x))
names(x)
replacement_tag
grep(names(x), replacement_tag)
/match()
?match
lapply(replacement_tag, match(names(x)))
lapply(replacement_tag, match, table = names(x))
unlist(lapply(replacement_tag, match, table = names(x)))
class(unlist(lapply(replacement_tag, match, table = names(x))))
x <- dplyr::mutate(x, test = "TEST")
names(x)
unlist(lapply(replacement_tag, match, table = names(x)))
which(!names(x) %in% tag_pattern$tag)
x <- dplyr::relocate(x, "test")
which(!names(x) %in% tag_pattern$tag)
devtools::load_all(".")
apa <- read_ris(file, "apa")
which(tag_pattern$tag %in% names(x))
names(x)
unlist(lapply(replacement_tag, match, table = names(x)))
x <- dplyr::select(x, -TY)
unlist(lapply(replacement_tag, match, table = names(x)))
which(names(x) %in% tag_pattern$tag)
which(!names(x) %in% tag_pattern$tag)
match <- unlist(lapply(replacement_tag, match, table = names(x)))
no_match <- which(!names(x) %in% tag_pattern$tag)
order <- append(match, no_match)
order
tag_pattern <- tag_pattern %>% dplyr::arrange(order)
replacement_index <- which(tag_pattern$tag %in% names(x))
replacement_tag <- tag_pattern$tag[replacement_index]
replacement_name <- tag_pattern$name[replacement_index]
match <- unlist(lapply(replacement_tag, match, table = names(x)))
no_match <- which(!names(x) %in% tag_pattern$tag)
order <- append(match, no_match)
order
subset(x, 2)
devtools::load_all(".")
apa <- read_ris(file, "apa")
temp <- head(apa, 101)
temp <- head(apa, 10)
View(temp)
devtools::load_all(".")
apa <- read_ris(file, "apa")
names(apa)
wos <- read_ris(tag_pattern = "apa")
View(wos)
temp <- head(wos, 10)
View(temp)
wos <- read_ris()
length(wos)
length(temp)
match
which(match == 000)
append(match, which(match == 000)
)
append(which(match == 000, match)
)
append(which(match == 000), match)
ebsco <- read_ris(tag_pattern = "apa")
temp <- head(ebsco, 10)
View(temp)
ebsco <- read_ris()
writeLines(names(ebsco), tempfile())
writeLines(names(ebsco), tempfile())
temp <- head(ebsco, 10)
View(temp)
head(ebsco$T3)
rm_na(head(ebsco$T3))
head(rm_na(ebsco$T3))
head(rm_na(ebsco$AV))
head(rm_na(ebsco$M1))
head(rm_na(ebsco$A2))
test <- dplyr::select(ebsco, JO, JF)
length(rm_na(ebsco$JO))
length(rm_na(ebsco$JF))
View(test)
test <- dplyr::tibble(a = 1, b = 1, c = 1)
dplyr::relocate(test, a, .after = )
dplyr::relocate(test, a, .after = c)
dplyr::last(names(test))
dplyr::relocate(test, a, .after = "c")
devtools::load_all(".")
devtools::load_all(".")
temp <- tail(ebsco, 10)
head(rm_na(ebsco$T3))
head(rm_na(ebsco$M1))
head(rm_na(ebsco$A2))
source('C:/Midia/GitHub/sqlr/data-raw/ris_tags.R')
ris_tags(TRUE)
devtools::load_all(".")
ebsco <- read_ris(tag_pattern = "ebsco")
x <- ebsco
(!("provider" %in% names(x)))
names(x)
(!"provider" %in% names(x))
debugonce(rename_ris)
ebsco <- read_ris(tag_pattern = "ebsco")
test <- rename_ris(ebsco)
rm(ris_tags())
rm(ris_tags)
devtools::load_all(".")
ris_tags$
ris_tags$ebsco
test <- rename_ris(ebsco, ris_tags$ebsco)
test <- rename_ris(ebsco, ris_tags$ebsco, "TEST")
View(test)
test <- rename_ris(ebsco, "ebsco", "TEST")
devtools::load_all(".")
ebsco <- read_ris(tag_pattern = "ebsco")
View(ebsco)
temp <- head(ebsco, 10)
View(temp)
unique(ebsco$file)
View(temp)
embase <- read_ris()
names(embase)
writeLines(names(embase), tempfile())
temp <- head(embase, 10)
unique(embase$DB)
embase$M1[1]
head(rm_na(embase$T2))
head(rm_na(embase$C2))
head(rm_na(embase$C1))
head(rm_na(embase$L1))
source('C:/Midia/GitHub/sqlr/data-raw/ris_tags.R')
ris_tags(TRUE)
devtools::load_all(".")
rm(ris_tags)
ris_tags$embase
embase <- read_ris()
embase <- read_ris(tag_pattern = "embase")
temp <- head(embase, 10)
View(temp)
available::available("reviewe")
available::available("reviewr")
available::available("reviewr")
available::available("review")
available::available("mctq")
available::available("reviewr")
available::available("shoulder")
available::available("sreview")
devtools::load_all(".")
pubmed <- read_ris()
names(pubmed)
tempdir()
normalizePath(tempdir())
normalizePath(tempdir(), "/")
writeLines(names(pubmed), tempfile())
temp <- head(pubmed, 10)
View(temp)
head(rm_na(pubmed$BTI))
which(!is.na(pubmed$BTI))
pubmed$TI[41]
names(pubmed)
"M3" %in% names(pubmed)
embase <- read_ris()
source('C:/Midia/GitHub/sqlr/data-raw/ris_tags.R')
devtools::load_all(".")
ris_tags(TRUE)
devtools::load_all(".")
rm(ris_tags)
devtools::load_all(".")
pubmed <- read_ris(lookup = "pubmed")
temp <- head(pubmed, 10)
View(temp)
use_r("normalize_files")
devtools::load_all(".")
use_r("normalize_files")
i <- "./inst/extdata/citation/"
new_name <- tolower(dir(i))
new_name <- stringr::str_replace_all(new_name, " - ", "_")
new_name <- stringr::str_replace_all(new_name, " ", "-")
new_name
devtools::load_all(".")
normalize_files()
