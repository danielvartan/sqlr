View(out)
devtools::load_all(".")
ls()[-"bkp"]
ls()
ls()[-1]
rm(list = ls()[-1])
devtools::load_all(".")
devtools::load_all(".")
devtools::load_all(".")
file <- "2021-04-27 - Citations - PubMed - 1-2869.nbib"
file <- raw_data("citation", file)
out <- read_ris(file)
View(out)
?readLines
?Encoding()
x <- readLines(x, encoding = "UTF-8")
x <- readLines(file, encoding = "UTF-8")
x[214]
x <- readLines(file)
Encoding(x)
readr::guess_encoding(file)
x <- readr::guess_encoding(file)
which(x$confidence = max(confidence))
which(x$confidence == max(confidence))
which(x$confidence == max(x$confidence))
?readr::guess_encoding
x$encoding[which(x$confidence == max(x$confidence))]
encoding <- readr::guess_encoding(file)
encoding <- readr::guess_encoding(file)
encoding <- encoding$encoding[which(encoding$confidence ==
max(encoding$confidence))]
devtools::load_all(".")
out <- read_ris(file)
View(out)
file <- "2021-04-27 - Citations - Web Of Science - EN - 1-1000.ris"
file <- raw_data("citation", file)
rm(bkp)
out <- read_ris(file)
View(out)
wos <- out
file <- "2021-04-28 - Citations - APA - EN - 1-500.ris"
file <- raw_data("citation", file)
out <- read_ris(file)
View(out)
apa <- out
checkmate::assert_character(file, min.len = 1, any.missing = FALSE,
all.missing = FALSE)
checkmate::assert_file_exists(file)
encoding <- readr::guess_encoding(file)
encoding <- encoding$encoding[which(encoding$confidence ==
max(encoding$confidence))]
data <- readLines(file[1], encoding = encoding, warn = FALSE)
index_1 <- vapply(data, stringr::str_detect, logical(1),
pattern = "^PMID$|^PMID |^PMID-")
index_2 <- vapply(data, stringr::str_detect, logical(1),
pattern = "^ER$|^ER |^ER-")
if (length(which(index_1 == TRUE)) >= length(which(index_2 == TRUE))) {
index <- which(index_1 == TRUE)
between <- "left"
} else {
index <- which(index_2 == TRUE)
between <- "right"
}
out <- cutter(data, index, between = between)
out <- lapply(out, function(x) x[!stringr::str_detect(x, "^\\s*$")])
out <- out[!lengths(out) == 0]
out
out[[1]]
bkp <- out
out <- remove_ris_header(out)
out[[1]]
out[[1]]
bkp <- out
out <- lapply(out, join_ris_solo_lines)
out[[1]]
bkp[[1]]
out[[1]]
x <- bkp[[1]]
pattern_tag <- "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))"
tag_detect <- stringr::str_detect(x, pattern_tag)
tagged_lines <- which(tag_detect == TRUE)
tagged_lines
stringr::str_detect("ER  -", pattern_tag)
stringr::str_detect("ER  -", ""^[A-Z][A-Z0-9]+")
stringr::str_detect("ER  -", "^[A-Z][A-Z0-9]+")
stringr::str_detect("ER  -", "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
View(apa)
names(appa)
names(apa)
file <- "2021-04-28 - Citations - EBSCO - EN - 1-1128.ris"
file <- raw_data("citation", file)
file
devtools::load_all(".")
out <- read_ris(file)
count_ris(file)
file
out <- chopp_ris(file)
out[[1]]
bkp <- out
out <- out %>% remove_ris_header()
out[[1]]
bkp <- out
out <- out %>% lapply(join_ris_solo_lines)
out[[1]]
bkp <- out
x <- out[[1]]
col <- stringr::str_extract(x, pattern_tag)
row <- trimws(stringr::str_extract(x, pattern_data))
pattern_tag <- "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))"
pattern_data <- "(?<=-).*"
col <- stringr::str_extract(x, pattern_tag)
row <- trimws(stringr::str_extract(x, pattern_data))
col
stringr::str_detect(col, "^ER$")
any(stringr::str_detect(col, "^ER$"))
which(stringr::str_detect(col, "^ER$"))
index <- which(stringr::str_detect(col, "^ER$"))
col[-index]
devtools::load_all(".")
out <- out %>% lapply(stringr::str_squish)
out[[1]]
bkp <- out
out <- out %>% lapply(join_ris_tag_values, sep = sep)
sep = " | "
out <- out %>% lapply(join_ris_tag_values, sep = sep)
out[[1]]
bkp <- out
out <- out %>% convert_ris_to_tibble()
stringr::str_detect(col, "^ER$")
any(stringr::str_detect(col, "^ER$"))
x <- out[[1]]
out <- dplyr::tibble()
envir <- environment()
pattern_tag <- "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))"
pattern_data <- "(?<=-).*"
col <- stringr::str_extract(x, pattern_tag)
row <- trimws(stringr::str_extract(x, pattern_data))
any(stringr::str_detect(col, "^ER$"))
col
?stringr::str_extract
rm_na(col)
devtools::load_all(".")
out <- out %>% convert_ris_to_tibble()
pattern_tag <- "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))"
pattern_data <- "(?<=-).*"
col <- rm_na(stringr::str_extract(x, pattern_tag))
row <- rm_na(trimws(stringr::str_extract(x, pattern_data)))
col
any(stringr::str_detect(col, "^ER$"))
?any
devtools::load_all(".")
pattern_tag <- "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))"
pattern_data <- "(?<=-).*"
col <- stringr::str_extract(x, pattern_tag)
row <- trimws(stringr::str_extract(x, pattern_data))
col
(any(stringr::str_detect(col, "^ER$"), na.rm = TRUE))
x <- data.frame(as.list(row))
names(x) <- col
View(x)
is.na(col)
which(is.na(col))
x <- out[[1]]
x <- bkp[[1]]
pattern_tag <- "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))"
pattern_data <- "(?<=-).*"
col <- stringr::str_extract(x, pattern_tag)
row <- trimws(stringr::str_extract(x, pattern_data))
if (any(stringr::str_detect(col, "^ER$"), na.rm = TRUE)) {
index <- which(stringr::str_detect(col, "^ER$"))
col <- col[-index]
row <- row[-index]
}
if (length(col) != length(row)) {
stop("The length of 'col' doesn't match the 'row' length.")
}
if (any(is.na(col))) {
index <- which(is.na(col))
col <- col[-index]
row <- row[-index]
}
x <- data.frame(as.list(row))
names(x) <- col
View(x)
out <- bkp
out <- out %>% convert_ris_to_tibble()
out <- bkp
devtools::load_all(".")
out <- out %>% convert_ris_to_tibble()
View(out)
file
ebsco <- read_ris(file)
file <- "2021-04-28 - Citations - Embase - EN - 1-4298.ris"
file <- raw_data("citation", file)
embase <- read_ris(file)
rep(1, 0)
rep(1, -1)
?duplicated
unique(c(1, NA, NA, 2))
?unique
devtools::load_all(".")
embase <- read_ris(file)
files
file
View(embase)
names(embase)
?anyDuplicated
devtools::load_all(".")
out <- chopp_ris(file)
out[[1]]
bkp <- out
out <- out %>% remove_ris_header()
out[[1]]
out <- bkp
pattern_tag <- "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))"
first_tag <- which(stringr::str_detect(x[[1]], pattern_tag) == TRUE)[1]
x <- out
pattern_tag <- "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))"
first_tag <- which(stringr::str_detect(x[[1]], pattern_tag) == TRUE)[1]
first_tag
stringr::str_detect(x[[1]], pattern_tag
)
x[[1]][1]
stringr::str_detect(x[[1]], "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
stringr::str_detect("TY  - JOUR", "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
stringr::str_detect(x[[1]][1], "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
"﻿TY  - JOUR"
stringr::str_detect(x[[1]][1], "^[.]?[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
as.character("﻿TY  - JOUR")
stringr::str_detect(as.character(x[[1]][1]), "^[.]?[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
x[[1]][1]
stringr::str_detect(as.character(x[[1]][1]), "^.[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
stringr::str_detect(as.character(x[[1]][1]), "^.?[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
stringr::str_detect(as.character("MF - "), "^.?[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
stringr::str_detect(as.character("MFsasa - "), "^.?[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
stringr::str_detect(as.character("MF- dsadsa"), "^.?[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
devtools::load_all(".")
embase <- read_ris(file)
file
View(embase)
file <- "2021-04-27 - Citations - Web Of Science - EN - 1-1000.ris"
file <- raw_data("citation", file)
wos <- read_ris(file)
View(wos)
names(wos)
out <- chopp_ris(file)
bkp <- out
out[[1]]
out[[2]]
out[[1]]
out[[1]]
stringr::str_detect(out[[1]], pattern_tag)
out[[1]][1]
stringr::str_detect(out[[1]][1], pattern_tag)
stringr::str_detect(out[[1]][1], "^[^A-Z]")
stringr::str_detect("AT - ", "^[^A-Z]")
out[[1]][1]
stringr::str_detect("ï»¿TY  - JOUR", "^[^A-Z]")
stringr::str_detect("ï»¿TY  - JOUR", "^[^A-Z]") && stringr::str_detect("ï»¿TY  - JOUR", "^.*[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
stringr::str_detect("ï»¿TY  - JOUR", "^.*[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
stringr::str_detect("TY  - JOUR", "^.*[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
stringr::str_detect("TY  - JOUR", "^[^A-Z]") && stringr::str_detect("TY  - JOUR", "^.*[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")
stringr::str_remove("ï»¿TY  - JOUR", "^.+(?=[A-Z]")
stringr::str_remove("ï»¿TY  - JOUR", "^.+(?=[A-Z])")
stringr::str_remove("ï»¿TY  - JOUR", "^[^A-Z]+(?=[A-Z])")
out <- chopp_ris(file)
out[[1]]
if (stringr::str_detect(x[[1]][1], "^[^A-Z]") &&
stringr::str_detect(x[[1]][1],
"^.*[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")) {
x[[1]][1] <- stringr::str_remove(x[[1]][1], "^[^A-Z]+(?=[A-Z])")
}
out[[1]]
x <- out
if (stringr::str_detect(x[[1]][1], "^[^A-Z]") &&
stringr::str_detect(x[[1]][1],
"^.*[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))")) {
x[[1]][1] <- stringr::str_remove(x[[1]][1], "^[^A-Z]+(?=[A-Z])")
}
x[[1]]
devtools::load_all(".")
file
wos <- read_ris(file)
View(wos)
file <- "2021-04-28 - Citations - EBSCO - EN - 1-1128.ris"
file <- raw_data("citation", file)
ebsco <- read_ris(file)
View(ebsco)
?subset
test <- out[c(1,2))
test <- out[c(1,2)]
subset(out, is.na(1))
test[[3]] <- character()
out
devtools::load_all(".")
file <- "2021-04-27 - Citations - PubMed - 1-2869.nbib"
file <- raw_data("citation", file)
pubmed <- read_ris(file)
devtools::load_all(".")
pubmed <- read_ris(file)
file
View(pubmed)
file <- "2021-04-28 - Citations - APA - EN - 1-500.ris"
file <- raw_data("citation", file)
apa <- read_ris(file)
View(apa)
out <- chopp_ris(file) %>%
remove_ris_header() %>%
lapply(join_ris_solo_lines) %>%
lapply(stringr::str_squish
out <- chopp_ris(file) %>%
remove_ris_header() %>%
lapply(join_ris_solo_lines) %>%
lapply(stringr::str_squish)
x <- out[[1]]
pattern_tag <- "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))"
tag_detect <- stringr::str_detect(x, pattern_tag)
tagged_lines <- which(tag_detect == TRUE)
tagged_lines
tag_detect
length(x)
pattern_tag <- "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))"
pattern_data <- "(?<=-).*"
tags <- stringr::str_extract(x, pattern_tag)
tags
x
duplicated_tags <- unique(tags[duplicated(tags)]) %>% rm_na()
duplicated_tags
out <- chopp_ris(file) %>%
remove_ris_header()
x <- out[[1]]
pattern_tag <- "^[A-Z][A-Z0-9]+(?=(-\\s+|\\s+-\\s+))"
tag_detect <- stringr::str_detect(x, pattern_tag)
tagged_lines <- which(tag_detect == TRUE)
tag_detect
devtools::load_all(".")
apa <- read_ris(file)
View(apa)
devtools::load_all(".")
file <- "2021-04-28 - Citations - EBSCO - EN - 1-1128.ris"
file <- raw_data("citation", file)
ebsco <- read_ris(file)
View(ebsco)
shush(alert("\nThis may take a while. Please be patient.\n"), quiet)
shush(alert("\nThis may take a while. Please be patient.\n"), FALSE)
shush(alert("\nThis may take a while. Please be patient.\n"), TRUE)
file <- "2021-04-28 - Citations - Scopus - EN - 1-1883.ris"
file <- raw_data("citation", file)
scopus <- read_ris(file)
View(scopus)
names(scopus)
stop("No citation/reference was identified in ", backtick_(file), ".",
call. = FALSE)
stop("No citation/reference was identified in ", single_quote_(file),
".", call. = FALSE)
stop("No citation/reference was identified in ", single_quote_(file),
".", call. = FALSE)
devtools::load_all(".")
devtools::load_all(".")
read_ris()
devtools::load_all(".")
read_ris()
apa <- read_ris()
View(apa)
names(apa)
file <- "2021-04-27 - Citations - PubMed - 1-2869.nbib"
file <- raw_data("citation", file)
temp <- file
file <- "2021-04-28 - Citations - APA - EN - 1-500.ris"
file <- raw_data("citation", file)
file <- append(file, temp)
file
test <- read_ris(file)
View(test)
names(test)
cyclocomp::cyclocomp(read_ris)
cyclocomp::cyclocomp(chopp_ris)
cyclocomp::cyclocomp(cutter)
?paste
?synthesisr::read_ref()
class(test)
provider_tags$apa
file <- "2021-04-27 - Citations - PubMed - EN - 1-2869.zip"
count_ris(raw_data("citation", file))
file <- "2021-04-28 - Citations - APA - EN - 1-1150.zip"
count_ris(raw_data("citation", file))
file <- "2021-04-28 - Citations - APA - EN - 1-1150.zip"
file <- raw_data("citation", file)
read_ris(file)
devtools::load_all(".")
?read_ris
View(apa)
duplicated(apa$DO)
return_duplications(apa$DO)
rm_na(return_duplications(apa$DO))
devtools::load_all(".")
View(test)
x <- stringr::str_extract(test$aid, "^[a-zA-Z0-9.]/[a-zA-Z0-9.]"
x <- stringr::str_extract(test$aid, "^[a-zA-Z0-9.]/[a-zA-Z0-9.]")
x <- stringr::str_extract(test$AID, "^[a-zA-Z0-9.]/[a-zA-Z0-9.]")
rm(x)
x <- stringr::str_extract(test$AID, "^[a-zA-Z0-9.]/[a-zA-Z0-9.]")
rm_na(x)
x <- stringr::str_extract(test$AID, "^[a-zA-Z0-9.]*/[a-zA-Z0-9.]*")
x <- rm_na(x)
x[1]
duplicate(c(1, 1, 3, 4, 4))
duplicates(c(1, 1, 3, 4, 4))
duplicated(c(1, 1, 3, 4, 4))
file <- c("2021-04-28 - Citations - APA - EN - 1-1150.zip",
"2021-04-28 - Citations - EBSCO - EN - 1-1128.zip")
file <- raw_data("citations", file)
file <- raw_data("citations", "2021-04-28 - Citations - APA - EN - 1-1150.zip")
file <- append(file, raw_data("citations",
"2021-04-28 - Citations - EBSCO - EN - 1-1128.zip"))
data <- read_ris(file)
devtools::load_all(".")
raw_data("citation", "2021-04-28 - Citations - APA - EN - 1-1150.zip")
file <- raw_data("citation", "2021-04-28 - Citations - APA - EN - 1-1150.zip")
file <- append(file, raw_data("citation",
"2021-04-28 - Citations - EBSCO - EN - 1-1128.zip"))
file
file <- raw_data("citation", "2021-04-28 - Citations - APA - EN - 1-1150.zip")
file <- append(file, raw_data("citation",
"2021-04-28 - Citations - EBSCO - EN - 1-1128.zip"))
data <- read_ris(file)
1150 + 1128
View(data)
doi <- stringr::str_extract(data$DO, pattern_doi)
duplicates <- return_duplications(doi)
pattern_doi <- "^[a-zA-Z0-9.]*/[a-zA-Z0-9.]*"
doi <- stringr::str_extract(data$DO, pattern_doi)
duplicates <- return_duplications(doi)
head(duplicates)
duplicated_index <- which(duplicated(doi))
duplicated_values <- return_duplications(doi)
head(duplicated_index)
head(duplicated_values)
duplicated_index <- which(duplicated(doi) && !is.na(doi))
duplicated_values <- return_duplications(doi)
duplicated_index <- which(!is.na(doi[duplicated(doi)]))
duplicated_index <- which(duplicated(doi) && !is.na(doi))
duplicated_index <- which(!is.na(doi))
duplicated_index <- which(duplicated(doi))
duplicated_index <- which(!is.na(doi) && duplicated(doi))
head(!is.na(doi))
head(duplicated(doi)
)
x <- c(1, 1, NA, NA, 2, 3, 4, 4)
!is.na(x)
duplicated(x)
!is.na(x) && duplicated(x)
!is.na(x) & duplicated(x)
duplicated_index <- which(!is.na(doi) & duplicated(doi))
pattern_doi <- "^[a-zA-Z0-9.]*/[a-zA-Z0-9.]*"
doi <- stringr::str_extract(data$DO, pattern_doi)
duplicated_index <- which(!is.na(doi) & duplicated(doi))
duplicated_values <- return_duplications(doi)
head(duplicated_index)
head(duplicated_values)
x <- dplyr::select(data, doi)
x <- dplyr::select(data, DO)
View(x)
pattern_doi <- "[^//s]*/[^//s]*"
doi <- stringr::str_extract(data$DO, pattern_doi)
pattern_doi <- "[^//s]*/[^//s]*"
doi <- stringr::str_extract(data$DO, pattern_doi)
duplicated_index <- which(!is.na(doi) & duplicated(doi))
duplicated_values <- return_duplications(doi)
head(duplicated_index)
head(duplicated_values)
x <- dplyr::select(data, DO)
head(duplicated_index)
head(duplicated_values)
pattern_doi <- "[^//s]*/[^//s]*"
doi <- stringr::str_extract(data$DO, pattern_doi)
duplicated_index <- which(!is.na(doi) & duplicated(doi))
duplicated_values <- return_duplications(doi)
x <- dplyr::tibble(DO = data$DO, doi = doi)
head(duplicated_index)
head(duplicated_values)
pattern_doi <- "[^ ]*/[^ ]*"
doi <- stringr::str_extract(data$DO, pattern_doi)
duplicated_index <- which(!is.na(doi) & duplicated(doi))
duplicated_values <- return_duplications(doi)
x <- dplyr::tibble(DO = data$DO, doi = doi)
head(duplicated_index)
head(duplicated_values)
which(x$DO == "10.1080/0167482X.2020.1734789")
not_equal <- which(x$DO != x$doi)
temp <- c("10.1080/0167482X.2020.1734789", "10.1080/0167482X.2020.1734789 [doi]")
stringr::str_extract(temp, pattern_doi)
devtools::load_all(".")
# Normalize file names
path <- "./inst/extdata/citation/"
path <- "./inst/extdata/search_history/"
new_name <- tolower(dir(path))
new_name <- stringr::str_replace_all(new_name, " - ", "_")
new_name <- stringr::str_replace_all(new_name, " ", "-")
file.rename(paste0(path, dir(path)), paste0(path, new_name))
path <- "./inst/extdata/citation/"
# path <- "./inst/extdata/search_history/"
new_name <- tolower(dir(path))
new_name <- stringr::str_replace_all(new_name, " - ", "_")
new_name <- stringr::str_replace_all(new_name, " ", "-")
file.rename(paste0(path, dir(path)), paste0(path, new_name))
devtools::load_all(".")
get_package_name()
devtools::load_all(".")
devtools::load_all(".")
cutter(seq(10), c(3, 9))
cutter(seq(10), c(3, 9), between = "left")
